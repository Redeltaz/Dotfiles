#!/usr/bin/env python3

import os
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("action", nargs="?", choices=["sync", "unlink", "copy"],
                    help="Choose what action to execute")
parser.add_argument('--skip', "-s", nargs="*", default=False,
                    help='If set, software choosed while not be affected by the action.')

args = parser.parse_args()
print(args)

supported_softwares = (
    "alacritty",
    "firefox",
    "git",
    "nvim",
    "tmux",
    "zsh"
)

class CLI:
    def __init__(self, supported_softwares, arg_list):
        self.args = arg_list
        self.software_list = list(supported_softwares)

    def init(self):
        if not self.args.action:
            print("You need to choose an action")
            exit(1)
        if self.args.skip:
            for skip in self.args.skip:
                if skip not in self.software_list:
                    print(f"The software '{skip}' is not supported to skip.")
                    exit(1)
                else:
                    self.software_list.remove(skip)

    def exec(self, action):
        if action == "pull":
            self.pull()
        elif action == "sync":
            self.sync()
        elif action == "unlink":
            self.unlink()
        else:
            print("This action does not exist")
            exit(1)

    def pull(self):
        print("pull")

    def sync(self):
        print("sync")

    def unlink(self):
        print("unlink")


dotfiles = CLI(supported_softwares, args)
dotfiles.init()
dotfiles.exec(args.action)
